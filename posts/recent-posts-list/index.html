<!doctype html> <html lang=en > <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155225320-2"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-155225320-2'); </script> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_lanyon.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=icon  href="/assets/favicon.ico"> <title>Recent Posts List in Franklin.jl</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>theoretically good with computers</a>.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">home</a> <a class="sidebar-nav-item " href="/posts/">posts</a> <a class="sidebar-nav-item " href="https://dblp1.uni-trier.de/pers/hd/c/Cognetta:Marco">publications</a> <a class="sidebar-nav-item " href="https://github.com/mcognetta">github</a> <a class="sidebar-nav-item " href="https://www.linkedin.com/in/mcognetta/">linkedin</a> <a class="sidebar-nav-item " href="assets/mccv.pdf">cv</a> <a class="sidebar-nav-item " href="/tags">all tags</a> </nav> <div class=sidebar-item > <p>&copy; Marco Cognetta.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/" title=Home >marco cognetta</a> <small>theoretically good with computers</small> </h3> </div> </div> <div class="container content"> <div class=franklin-content ><h1 id=recent_posts_list_in_franklinjl ><a href="#recent_posts_list_in_franklinjl" class=header-anchor >Recent Posts List in Franklin.jl</a></h1> <p>On my main page, I have a ticker that lists my recent posts. This list is generated by a key feature of Franklin.jl, <code>hfun</code><sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup>. In short, an <code>hfun</code> is a Julia function that is run at site-generation time and produces HTML to be plugged into the page. These functions are defined in the <code>utils.jl</code> file in your site repo and can be called by including <code>&#123;&#123; func &#125;&#125;</code> in your markdown file &#40;when the function is named <code>hfun_func</code>&#41;. For example, the following <code>hfun</code> will produce the italicized, reversed title of the page wherever <code>&#123;&#123; reverse_title &#125;&#125;</code> is called, like so: <i>lj.nilknarF ni tsiL stsoP tneceR</i>.</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> hfun_reverse_title()
  <span class=hljs-keyword >return</span> <span class=hljs-string >&quot;&lt;i&gt;&quot;</span> * reverse(locvar(:title)) * <span class=hljs-string >&quot;&lt;/i&gt;&quot;</span>
<span class=hljs-keyword >end</span></code></pre> <p>Rather than writing HTML directly, arbitrary markdown code can be converted to HTML via the <code>fd2html</code> function. Furthermore, a string vector can be passed as parameters, as in: <code>&#123;&#123; func param1 param2 param3 &#125;&#125;</code>.</p> <p>In the Franklin docs, the following <code>hfun</code> is provided as an example of listing all posts chronologically:</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> hfun_recentblogposts()
    list = readdir(<span class=hljs-string >&quot;blog&quot;</span>)
    filter!(f -&gt; endswith(f, <span class=hljs-string >&quot;.md&quot;</span>), list)
    dates = [stat(joinpath(<span class=hljs-string >&quot;blog&quot;</span>, f)).mtime <span class=hljs-keyword >for</span> f <span class=hljs-keyword >in</span> list]
    perm = sortperm(dates, rev=<span class=hljs-literal >true</span>)
    idxs = perm[<span class=hljs-number >1</span>:min(<span class=hljs-number >3</span>, length(perm))]
    io = <span class=hljs-built_in >IOBuffer</span>()
    write(io, <span class=hljs-string >&quot;&lt;ul&gt;&quot;</span>)
    <span class=hljs-keyword >for</span> (k, i) <span class=hljs-keyword >in</span> enumerate(idxs)
        fi = <span class=hljs-string >&quot;/blog/&quot;</span> * splitext(list[i])[<span class=hljs-number >1</span>] * <span class=hljs-string >&quot;/&quot;</span>
        write(io, <span class=hljs-string >&quot;&quot;&quot;&lt;li&gt;&lt;a href=&quot;<span class=hljs-variable >$fi</span>&quot;&gt;Post <span class=hljs-variable >$k</span>&lt;/a&gt;&lt;/li&gt;\n&quot;&quot;&quot;</span>)
    <span class=hljs-keyword >end</span>
    write(io, <span class=hljs-string >&quot;&lt;/ul&gt;&quot;</span>)
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >String</span>(take!(io))
<span class=hljs-keyword >end</span></code></pre> <p>This function works quite well, except that it uses <code>stats&#40;file&#41;.mtime</code> to extract the most recently modified time of the file which is then used for sorting. This does not accurately convey the posts&#39; chronological order as one may write a post and fix a typo in it many years later causing the <code>mtime</code> to be much more recent than posts written after it. It also does not allow for limiting the number of posts that are given. In my <code>utils.jl</code>, I have a simple <code>hfun</code> that uses the posts&#39; dates page variable<sup id="fnref:2"><a href="#fndef:2" class=fnref >[2]</a></sup> and accepts a parameter that limits the number of posts to output. It produces a list of the <code>k</code> most recent posts in reverse chronological order, which I include in my main page. The function requires that all posts are written as markdown files in the <code>posts</code> directory and that the dates are in <code>mm/dd/yyyy</code> format. When a negative number is passed in for <code>k</code>, all posts are listed, otherwise only <code>k</code> are given.</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> hfun_recent_posts(m::<span class=hljs-built_in >Vector</span>{<span class=hljs-built_in >String</span>})
  <span class=hljs-meta >@assert</span> length(m) == <span class=hljs-number >1</span> <span class=hljs-string >&quot;only one argument allowed for recent posts (the number of recent posts to pull)&quot;</span>
  n = parse(<span class=hljs-built_in >Int64</span>, m[<span class=hljs-number >1</span>])
  list = readdir(<span class=hljs-string >&quot;posts&quot;</span>)
  filter!(f -&gt; endswith(f, <span class=hljs-string >&quot;.md&quot;</span>) &amp;&amp; f != <span class=hljs-string >&quot;index.md&quot;</span> , list)
  markdown = <span class=hljs-string >&quot;&quot;</span>
  posts = []
  df = DateFormat(<span class=hljs-string >&quot;mm/dd/yyyy&quot;</span>)
  <span class=hljs-keyword >for</span> (k, post) <span class=hljs-keyword >in</span> enumerate(list)
      fi = <span class=hljs-string >&quot;posts/&quot;</span> * splitext(post)[<span class=hljs-number >1</span>]
      title = pagevar(fi, :title)
      datestr = pagevar(fi, :date)
      date = Date(pagevar(fi, :date), df)
      push!(posts, (title=title, link=fi, date=date))
  <span class=hljs-keyword >end</span>

  <span class=hljs-comment ># pull all posts if n &lt;= 0</span>
  n = n &gt;= <span class=hljs-number >0</span> ? n : length(posts)+<span class=hljs-number >1</span>

  <span class=hljs-keyword >for</span> ele <span class=hljs-keyword >in</span> sort(posts, by=x-&gt;x.date, rev=<span class=hljs-literal >true</span>)[<span class=hljs-number >1</span>:min(length(posts), n)]
    markdown *= <span class=hljs-string >&quot;* [(<span class=hljs-subst >$(ele.date)</span>) <span class=hljs-subst >$(ele.title)</span>](../<span class=hljs-subst >$(ele.link)</span>)\n&quot;</span>
  <span class=hljs-keyword >end</span>

  <span class=hljs-keyword >return</span> fd2html(markdown, internal=<span class=hljs-literal >true</span>)
<span class=hljs-keyword >end</span></code></pre> <p>In my main <code>index.md</code> file, this is called as <code>&#123;&#123; recent_posts 3 &#125;&#125;</code> to produce the list. I hope this function comes in handy for others that are using Franklin to implement their websites.</p> <p><table class=fndef  id="fndef:1"> <tr> <td class=fndef-backref ><a href="#fnref:1">[1]</a> <td class=fndef-content ><a href="https://franklinjl.org/syntax/utils/#html_functions_hfun_">https://franklinjl.org/syntax/utils/#html&#95;functions&#95;hfun_</a> </table> <table class=fndef  id="fndef:2"> <tr> <td class=fndef-backref ><a href="#fnref:2">[2]</a> <td class=fndef-content ><a href="https://franklinjl.org/syntax/page-variables/#basic_settings">https://franklinjl.org/syntax/page-variables/#basic_settings</a> </table> </p> <div class=page-foot > <div class=copyright > &copy; Marco Cognetta. Last modified: December 11, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>. </div> </div> </div> </div> </div> <label for=sidebar-checkbox  class=sidebar-toggle ></label>